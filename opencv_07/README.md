
# ðŸ“Œ K-í‰ê·  í´ëŸ¬ìŠ¤í„°ë§(K-means Clustering)
- ì°¸ê³  : [ë‚´ìš©](https://bkshin.tistory.com/entry/%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-7-K-%ED%8F%89%EA%B7%A0-%EA%B5%B0%EC%A7%91%ED%99%94-K-means-Clustering), [í´ëŸ¬ìŠ¤í„°ë§ ì‹œê°í™” ì‹œë®¬ë ˆì´ì…˜](https://www.naftaliharris.com/blog/visualizing-k-means-clustering/)
- í´ëŸ¬ìŠ¤í„°ëž€ ë¹„ìŠ·í•œ íŠ¹ì„±ì„ ê°€ì§„ ë°ì´í„°ë¼ë¦¬ì˜ ë¬¶ìŒ
- í´ëŸ¬ìŠ¤í„°ë§ì´ëž€ ì–´ë–¤ ë°ì´í„°ë“¤ì´ ì£¼ì–´ì¡Œì„ ë•Œ, ê·¸ ë°ì´í„°ë“¤ì„ í´ëŸ¬ìŠ¤í„°ë¡œ ê·¸ë£¹í™” ì‹œì¼œì£¼ëŠ” ê²ƒ

## âœ” í”„ë¡œì„¸ìŠ¤
1. ì–¼ë§ˆë‚˜ ë§Žì€ í´ëŸ¬ìŠ¤í„°ê°€ í•„ìš”í•œì§€ ê²°ì •(`K` ê²°ì •)
2. ì´ˆê¸° `Centroid`(ê° í´ëŸ¬ìŠ¤í„°ì˜ ì¤‘ì‹¬) ì„ íƒ
   -  ëžœë¤í•˜ê²Œ ì„¤ì •
   -  ìˆ˜ë™ìœ¼ë¡œ ì„¤ì •
   -  Kmean++ ë°©ë²•
3. ëª¨ë“  ë°ì´í„°ë¥¼ ìˆœíšŒí•˜ë©° ê° ë°ì´í„°ë§ˆë‹¤ ê°€ìž¥ ê°€ê¹Œìš´ `Centroid`ê°€ ì†í•´ìžˆëŠ” í´ëŸ¬ìŠ¤í„°ë¡œ assign
4. `Centroid`ë¥¼ í´ëŸ¬ìŠ¤í„°ì˜ ì¤‘ì‹¬ìœ¼ë¡œ ì´ë™
5. í´ëŸ¬ìŠ¤í„°ì— assign ë˜ëŠ” ë°ì´í„°ê°€ ì—†ì„ ë•Œê¹Œì§€ ìŠ¤í… 3,4ë¥¼ ë°˜ë³µ

## âœ” K-means ë‹¨ì 
- í´ëŸ¬ìŠ¤í„° ê°œìˆ˜(`K`)ë¥¼ ë¯¸ë¦¬ ì§€ì •í•´ì•¼ í•¨ : ê°€ìž¥ í° ë‹¨ì  ì¤‘ í•˜ë‚˜. ì‚¬ìš©ìžê°€ ì‚¬ì „ì— ìµœì ì˜ `K`ê°’ì„ ì•Œê¸° ì–´ë µë‹¤.
- ì´ˆê¸° ì¤‘ì‹¬ì  ì„ íƒì— ë¯¼ê° : ì´ˆê¸°ì— ì–´ë–¤ ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ì¤‘ì‹¬ì ìœ¼ë¡œ ì„ íƒí•˜ëŠëƒì— ë”°ë¼ ìµœì¢… í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆë‹¤.
- êµ¬í˜•(Spherical) í´ëŸ¬ìŠ¤í„°ì—ë§Œ íš¨ê³¼ì  : ë³µìž¡í•˜ê±°ë‚˜ ê¸¸ì­‰í•œ í˜•íƒœì˜ í´ëŸ¬ìŠ¤í„°ì—ëŠ” ì í•©í•˜ì§€ ì•Šë‹¤.
- ì´ìƒì¹˜(Outlier)ì— ë¯¼ê° : ë°ì´í„° ë¶„í¬ì—ì„œ ë©€ë¦¬ ë–¨ì–´ì§„ ë°ì´í„° í¬ì¸íŠ¸ê°€ ìžˆì„ ê²½ìš°, ì¤‘ì‹¬ì ì„ í¬ê²Œ ì´ë™ì‹œí‚¬ ìˆ˜ ìžˆë‹¤.
- ë°ì´í„°ì˜ í¬ê¸°(Scale)ì— ë¯¼ê° : ê° ë³€ìˆ˜(íŠ¹ì„±)ì˜ ê°’ ë²”ìœ„ê°€ í¬ê²Œ ë‹¤ë¥´ë©´, í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼ê°€ ì™œê³¡ë  ìˆ˜ ìžˆë‹¤.

---

# ðŸ“Œ ì°¨ì„  ìƒ‰ìƒ ë¶„ë¥˜ ì‹¤ìŠµ (K-means í™œìš©)

## 1. ëª©í‘œ
- ì‹œê°ì  ê²°ê³¼: ì›ë³¸ì´ë¯¸ì§€ , ê²°ê³¼ì´ë¯¸ì§€
- ìƒ‰ìƒ íŒ”ë ˆíŠ¸: ì¶”ì¶œëœ 4ê°€ì§€ ëŒ€í‘œ ìƒ‰ìƒ
- ë¶„í¬ ì°¨íŠ¸: ê° ìƒ‰ìƒì´ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨
- ìƒì„¸ ë¶„ì„: BGR ê°’ê³¼ í”½ì…€ ìˆ˜/ë¹„ìœ¨ ì •ë³´

## 2. ë™ìž‘ì„¤ëª…

### 1. ì´ë¯¸ì§€ ì¤€ë¹„ ë° ROI(ê´€ì‹¬ ì˜ì—­) ì„ íƒ
- ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¨ ë’¤ `cv2.selectROI` í•¨ìˆ˜ë¥¼ í†µí•´ ì‚¬ìš©ìžê°€ ë¶„ì„ì„ ì›í•˜ëŠ” íŠ¹ì • ì˜ì—­(ROI)ì„ ì§ì ‘ ì§€ì •í•œë‹¤.
- ì„ íƒëœ ROIì˜ ì¢Œí‘œë¥¼ ì›ë³¸ ì´ë¯¸ì§€ í¬ê¸°ì— ë§žê²Œ ë‹¤ì‹œ ë³€í™˜í•˜ì—¬ ì›ë³¸ ì´ë¯¸ì§€ì—ì„œ í•´ë‹¹ ROIë¥¼ ìž˜ë¼ë‚¸ë‹¤.
> <img width="350" height="411" alt="image" src="https://github.com/user-attachments/assets/920d3731-22b4-427c-a065-6b53e13a6fc2" />


### 2. K-meansë¥¼ ìœ„í•œ ë°ì´í„° ì¤€ë¹„
- ì„ íƒëœ ROI ì´ë¯¸ì§€ë¥¼ BGR ìƒ‰ ê³µê°„ì—ì„œ HSV ìƒ‰ ê³µê°„ìœ¼ë¡œ ë³€í™˜
- ì´ë¯¸ì§€ì˜ í”½ì…€ ë°ì´í„°ë¥¼ K-means ì•Œê³ ë¦¬ì¦˜ì— ìž…ë ¥í•˜ê¸° ìœ„í•´, roi_hsv ì´ë¯¸ì§€ë¥¼ (í”½ì…€ ìˆ˜, 3) í˜•íƒœì˜ 2ì°¨ì› ë°°ì—´ë¡œ ë³€í™˜í•œë‹¤.
  
### 3. K-means í´ëŸ¬ìŠ¤í„°ë§
- `cv2.kmeans` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ K-means í´ëŸ¬ìŠ¤í„°ë§ì„ ì‹¤í–‰
- `K=4`ë¡œ ì„¤ì •í•˜ì—¬ ROI ë‚´ì˜ ëª¨ë“  í”½ì…€ë“¤ì„ 4ê°œì˜ ì£¼ìš” ìƒ‰ìƒ ê·¸ë£¹ìœ¼ë¡œ ë¬¶ëŠ”ë‹¤.
- ë¶„ì„ì„ ìœ„í•´ HSV ì¤‘ì‹¬ì ë“¤ì„ ë‹¤ì‹œ BGR ìƒ‰ìƒìœ¼ë¡œ ë³€í™˜í•œë‹¤.
  
### 4. í´ëŸ¬ìŠ¤í„°ë§ ì´ë¯¸ì§€ ìƒì„± ë° ë¶„ì„
- ê° í”½ì…€ì´ ì–´ë–¤ í´ëŸ¬ìŠ¤í„°ì— ì†í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” labels ë°°ì—´ì„ ì‚¬ìš©í•˜ì—¬, ì›ë³¸ ROIì˜ ê° í”½ì…€ì„ í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì˜ ëŒ€í‘œ ìƒ‰ìƒ(ì¤‘ì‹¬ì )ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤.
- `np.bincount`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê° í´ëŸ¬ìŠ¤í„°ì— ì†í•œ í”½ì…€ì˜ ìˆ˜ë¥¼ ì„¸ì–´, ê° ìƒ‰ìƒì´ ì „ì²´ ì´ë¯¸ì§€ì—ì„œ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ì„ ê³„ì‚°í•œë‹¤.
- ë¶„ì„ëœ ëŒ€í‘œ ìƒ‰ìƒì˜ BGR ê°’, í”½ì…€ ìˆ˜, ê·¸ë¦¬ê³  ë¹„ìœ¨ì„ ì¶œë ¥í•œë‹¤.

### 5. ì‹œê°í™”
- `matplotlib`ì„ ì‚¬ìš©í•˜ì—¬ ë¶„ì„ ê²°ê³¼ë¥¼ ì‹œê°í™”
> <img width="500" height="600" alt="image" src="https://github.com/user-attachments/assets/7afbc4e1-8a1c-417f-8a80-56b7a6a97cb6" />

  
## 3. ì‹¤í–‰
```bash
#./src/
python load_line_color.py
```

---

