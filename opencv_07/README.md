
# 📌 K-평균 클러스터링(K-means Clustering)
- 참고 : [내용](https://bkshin.tistory.com/entry/%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-7-K-%ED%8F%89%EA%B7%A0-%EA%B5%B0%EC%A7%91%ED%99%94-K-means-Clustering), [클러스터링 시각화 시뮬레이션](https://www.naftaliharris.com/blog/visualizing-k-means-clustering/)
- 클러스터란 비슷한 특성을 가진 데이터끼리의 묶음
- 클러스터링이란 어떤 데이터들이 주어졌을 때, 그 데이터들을 클러스터로 그룹화 시켜주는 것

## ✔ 프로세스
1. 얼마나 많은 클러스터가 필요한지 결정(`K` 결정)
2. 초기 `Centroid`(각 클러스터의 중심) 선택
   -  랜덤하게 설정
   -  수동으로 설정
   -  Kmean++ 방법
3. 모든 데이터를 순회하며 각 데이터마다 가장 가까운 `Centroid`가 속해있는 클러스터로 assign
4. `Centroid`를 클러스터의 중심으로 이동
5. 클러스터에 assign 되는 데이터가 없을 때까지 스텝 3,4를 반복

## ✔ K-means 단점
- 클러스터 개수(`K`)를 미리 지정해야 함 : 가장 큰 단점 중 하나. 사용자가 사전에 최적의 `K`값을 알기 어렵다.
- 초기 중심점 선택에 민감 : 초기에 어떤 데이터 포인트를 중심점으로 선택하느냐에 따라 최종 클러스터링 결과가 달라질 수 있다.
- 구형(Spherical) 클러스터에만 효과적 : 복잡하거나 길쭉한 형태의 클러스터에는 적합하지 않다.
- 이상치(Outlier)에 민감 : 데이터 분포에서 멀리 떨어진 데이터 포인트가 있을 경우, 중심점을 크게 이동시킬 수 있다.
- 데이터의 크기(Scale)에 민감 : 각 변수(특성)의 값 범위가 크게 다르면, 클러스터링 결과가 왜곡될 수 있다.

---

# 📌 차선 색상 분류 실습 (K-means 활용)

## 1. 목표
- 시각적 결과: 원본이미지 , 결과이미지
- 색상 팔레트: 추출된 4가지 대표 색상
- 분포 차트: 각 색상이 차지하는 비율
- 상세 분석: BGR 값과 픽셀 수/비율 정보

## 2. 동작설명

### 1. 이미지 준비 및 ROI(관심 영역) 선택
- 이미지를 불러온 뒤 `cv2.selectROI` 함수를 통해 사용자가 분석을 원하는 특정 영역(ROI)을 직접 지정한다.
- 선택된 ROI의 좌표를 원본 이미지 크기에 맞게 다시 변환하여 원본 이미지에서 해당 ROI를 잘라낸다.
> <img width="350" height="411" alt="image" src="https://github.com/user-attachments/assets/920d3731-22b4-427c-a065-6b53e13a6fc2" />


### 2. K-means를 위한 데이터 준비
- 선택된 ROI 이미지를 BGR 색 공간에서 HSV 색 공간으로 변환
- 이미지의 픽셀 데이터를 K-means 알고리즘에 입력하기 위해, roi_hsv 이미지를 (픽셀 수, 3) 형태의 2차원 배열로 변환한다.
  
### 3. K-means 클러스터링
- `cv2.kmeans` 함수를 사용하여 K-means 클러스터링을 실행
- `K=4`로 설정하여 ROI 내의 모든 픽셀들을 4개의 주요 색상 그룹으로 묶는다.
- 분석을 위해 HSV 중심점들을 다시 BGR 색상으로 변환한다.
  
### 4. 클러스터링 이미지 생성 및 분석
- 각 픽셀이 어떤 클러스터에 속하는지를 나타내는 labels 배열을 사용하여, 원본 ROI의 각 픽셀을 해당 클러스터의 대표 색상(중심점)으로 대체한다.
- `np.bincount`를 사용하여 각 클러스터에 속한 픽셀의 수를 세어, 각 색상이 전체 이미지에서 차지하는 비율을 계산한다.
- 분석된 대표 색상의 BGR 값, 픽셀 수, 그리고 비율을 출력한다.

### 5. 시각화
- `matplotlib`을 사용하여 분석 결과를 시각화
> <img width="500" height="600" alt="image" src="https://github.com/user-attachments/assets/7afbc4e1-8a1c-417f-8a80-56b7a6a97cb6" />

  
## 3. 실행
```bash
#./src/
python load_line_color.py
```

---

